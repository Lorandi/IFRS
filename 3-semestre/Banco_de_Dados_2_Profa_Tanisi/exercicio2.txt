--1. Apresentar o nome do curso e as disciplinas.
select c.nome_curso, d.nome_disciplina 
from curso c full outer join disciplina d
on c.id_curso = d.id_curso
order by c.nome_curso;

--2. Apresentar o nome do professor e a sua Ã¡rea
select p.nome_professor, a.nome_area
from professor p full outer join area a
on p.id_area = a.id_area
order by p.nome_professor;

--3. Apresentar o cÃ³digo da turma, o semestre, o nome do aluno e a nota final
select t.id_turma, t.semestre, a.nome_aluno, tm.media_final
from turma t inner join turma_aluno tm
on t.id_turma = tm.id_turma
inner join aluno a
on a.id_aluno = tm.id_aluno
order by t.id_turma;

--4. Apresentar o nome do aluno, o nome do curso para os alunos que jÃ¡ concluÃ­ram o curso.
select a.nome_aluno, c.nome_curso
from aluno a inner join aluno_curso ac
on a.id_aluno = ac.id_aluno
inner join curso c
on c.id_curso = ac.id_curso
where ac.data_fim is not null; 


--5. Apresentar cÃ³digo da turma , o nome da disciplina e o nome do professor
SELECT t.ID_TURMA , d.NOME_DISCIPLINA , p.NOME_PROFESSOR  
FROM TURMA t INNER JOIN DISCIPLINA d 
ON t.ID_DISCIPLINA = d.ID_DISCIPLINA 
INNER JOIN PROFESSOR p 
ON t.ID_PROFESSOR = p.ID_PROFESSOR ;



--6. Apresentar o nome da disciplina e a nota_final das disciplinas cursadas pelo Aluno Bruno no semestre 2018/1;
SELECT d.NOME_DISCIPLINA , ta.MEDIA_FINAL 
FROM DISCIPLINA d INNER JOIN TURMA t
ON d.ID_DISCIPLINA = t.ID_DISCIPLINA 
INNER JOIN TURMA_ALUNO ta  
ON ta.ID_TURMA = t.ID_TURMA 
INNER JOIN ALUNO a 
ON ta.ID_ALUNO = a.ID_ALUNO 
WHERE t.SEMESTRE = '2018/1' AND a.NOME_ALUNO = 'Bruno';

--7. Apresentar o nome dos alunos que foram aprovados na disciplina de BDI no semestre de 2018/1;
SELECT a.NOME_ALUNO 
FROM ALUNO a INNER JOIN TURMA_ALUNO ta 
ON a.ID_ALUNO = ta.ID_ALUNO 
INNER JOIN TURMA t 
ON ta.ID_TURMA = t.ID_TURMA 
INNER JOIN DISCIPLINA d 
ON t.ID_DISCIPLINA = d.ID_DISCIPLINA 
WHERE d.NOME_DISCIPLINA = 'BDI' AND t.SEMESTRE = '2018/1' AND ta.MEDIA_FINAL >= 7 ;


--8. Apresentar o total de alunos matriculados nas turmas do semestre 2018/1.
SELECT t.ID_TURMA, COUNT(ta.ID_ALUNO) AS total_alunos
FROM TURMA_ALUNO ta
INNER JOIN TURMA t ON ta.ID_TURMA = t.ID_TURMA
WHERE t.SEMESTRE = '2018/1'
GROUP BY t.ID_TURMA;


--9. Apresentar a mÃ©dia geral na disciplina de BDI em 2018/1.
SELECT AVG(ta.MEDIA_FINAL)
FROM TURMA_ALUNO ta INNER JOIN TURMA t 
ON ta.ID_TURMA = t.ID_TURMA 
INNER JOIN DISCIPLINA d 
ON t.ID_DISCIPLINA = d.ID_DISCIPLINA 
WHERE d.NOME_DISCIPLINA = 'BDI' AND t.SEMESTRE = '2018/1';


--10. Apresentar o cÃ³digo da turma, nome da disciplina e quantidade de alunos para as turma de 2018/1.
SELECT t.ID_TURMA, d.NOME_DISCIPLINA , COUNT(ta.ID_ALUNO) 
FROM TURMA_ALUNO ta INNER JOIN TURMA t 
ON ta.ID_TURMA = t.ID_TURMA 
INNER JOIN DISCIPLINA d ON t.ID_DISCIPLINA = d.ID_DISCIPLINA 
WHERE t.SEMESTRE = '2018/1'
GROUP BY t.ID_TURMA , d.NOME_DISCIPLINA ;



--11. Apresentar o cÃ³digo da turma, nome da disciplina para as turma de 2018/1 com mais de 30 alunos.
SELECT t.ID_TURMA, d.NOME_DISCIPLINA 
FROM TURMA_ALUNO ta 
INNER JOIN TURMA t ON ta.ID_TURMA = t.ID_TURMA 
INNER JOIN DISCIPLINA d ON t.ID_DISCIPLINA = d.ID_DISCIPLINA 
WHERE t.SEMESTRE = '2018/1' 
GROUP BY t.ID_TURMA, d.NOME_DISCIPLINA
HAVING COUNT(ta.ID_ALUNO) > 30;


--12. Apresentar o nome da Ã¡rea e o total de cursos da Ã¡rea. Se a Ã¡rea nÃ£o tiver nenhum curso deve aparecer o total de cursos 0.
SELECT a.NOME_AREA , count(c.ID_CURSO) AS total_de_cursos
FROM AREA a 
LEFT outer JOIN CURSO c ON a.ID_AREA = c.ID_AREA
GROUP BY a.NOME_AREA ; 

--13. Apresentar o nome do professor e o total de disciplinas ministradas por este professor. Se o professor nÃ£o ministrar nenhuma disciplina deve aparecer o valor 0.
SELECT p.NOME_PROFESSOR ,count(d.ID_CURSO) AS total_de_disciplinas
FROM PROFESSOR p 
LEFT outer JOIN DISCIPLINA d  ON p.ID_CURSO = d.ID_CURSO 
GROUP BY p.NOME_PROFESSOR ; 


--14. Apresentar o nome dos cursos e o total de turmas ofertadas em 2018/1. Se o curso nÃ£o tiver nenhuma turma ele deve aparecer tambÃ©m com o total de turma 0.
SELECT c.NOME_CURSO , count(t.ID_TURMA)
FROM CURSO c 
left join DISCIPLINA d  ON c.ID_CURSO = d.ID_CURSO 
left JOIN TURMA t ON t.ID_DISCIPLINA = d.ID_DISCIPLINA
WHERE t.SEMESTRE = '2018/1'
GROUP BY c.NOME_CURSO ;